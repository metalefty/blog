+++
date = "2017-11-28"
draft = false
lastmod = "2017-11-28T11:55:47+09:00"
tags = ["xrdp"]
title = "xrdp-sesman の脆弱性 CVE-2017-16927 を修正しました"
+++


各所から情報が公開されていますが、xrdp を構成する1コンポーネントである xrdp-sesman にバッファオーバーフローの脆弱性が発見されました。本脆弱性は既に修正済みですが、脆弱性のみを修正するリリースは行わず、来月2017年12月に予定している定期リリースに含む予定です。

- http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16927
- https://www.suse.com/security/cve/CVE-2017-16927/
- https://security-tracker.debian.org/tracker/CVE-2017-16927
- https://bugzilla.redhat.com/show_bug.cgi?id=1516759
- https://oss.sios.com/security/xrdp-security-vulnerability-20171124

xrdp-sesman の `sesman/libscp/libscp_v0.c` の `scp_v0s_accept` 関数内で、ネットワークから受け取った信頼できない整数値をサイズとして、固定長のバッファに書き込んでいました。これにより、xrdp-sesman プロセスのクラッシュにより DoS が発生する可能性があります。

デフォルトの設定では、xrdp-sesman は localhost:3350 を LISTEN しているため、リモートからの攻撃は受けず、ローカルユーザによる攻撃に限定されます。

パッチは下記の通り、可変長のバッファを確保することで対応しています。

- https://github.com/neutrinolabs/xrdp/pull/958/files

